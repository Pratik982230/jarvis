# ============================================================
# üóÉÔ∏è SQLite Database Access - CRUD Operations
# ============================================================

import sqlite3

# ----------- CONNECT TO DATABASE -----------
conn = sqlite3.connect("students.db")   # Creates file if not exists
cursor = conn.cursor()

# ----------- CREATE TABLE -----------
cursor.execute("""
CREATE TABLE IF NOT EXISTS students (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    name TEXT NOT NULL,
    age INTEGER,
    grade TEXT
)
""")
conn.commit()

# ----------- FUNCTIONS -----------
def insert_student():
    name = input("Enter student name: ")
    age = int(input("Enter age: "))
    grade = input("Enter grade: ")
    cursor.execute("INSERT INTO students (name, age, grade) VALUES (?, ?, ?)", (name, age, grade))
    conn.commit()
    print("‚úÖ Student added successfully!\n")

def view_students():
    cursor.execute("SELECT * FROM students")
    rows = cursor.fetchall()
    if not rows:
        print("‚ö†Ô∏è No records found.\n")
    else:
        print("\nüìò All Students:")
        for row in rows:
            print(row)
        print()

def search_students():
    age_limit = int(input("Enter minimum age to search: "))
    cursor.execute("SELECT * FROM students WHERE age > ?", (age_limit,))
    rows = cursor.fetchall()
    if not rows:
        print("‚ö†Ô∏è No students found above that age.\n")
    else:
        print("\nüéØ Students older than", age_limit, ":")
        for row in rows:
            print(row)
        print()

def update_student():
    view_students()
    sid = int(input("Enter ID of student to update: "))
    new_grade = input("Enter new grade: ")
    cursor.execute("UPDATE students SET grade = ? WHERE id = ?", (new_grade, sid))
    conn.commit()
    if cursor.rowcount > 0:
        print("‚úÖ Student updated successfully!\n")
    else:
        print("‚ö†Ô∏è No record found with that ID.\n")

def delete_student():
    view_students()
    sid = int(input("Enter ID of student to delete: "))
    cursor.execute("DELETE FROM students WHERE id = ?", (sid,))
    conn.commit()
    if cursor.rowcount > 0:
        print("üóëÔ∏è Student deleted successfully!\n")
    else:
        print("‚ö†Ô∏è No record found with that ID.\n")

def drop_table():
    confirm = input("‚ö†Ô∏è Do you really want to delete the entire table? (yes/no): ")
    if confirm.lower() == 'yes':
        cursor.execute("DROP TABLE IF EXISTS students")
        conn.commit()
        print("‚ö†Ô∏è Table dropped successfully!\n")
    else:
        print("‚ùé Table not dropped.\n")

# ----------- MENU -----------
while True:
    print("""
==============================
   üóÉÔ∏è SQLite CRUD Operations
==============================
1Ô∏è‚É£ Insert new student
2Ô∏è‚É£ View all students
3Ô∏è‚É£ Search students by age
4Ô∏è‚É£ Update student grade
5Ô∏è‚É£ Delete a student
6Ô∏è‚É£ Drop entire table
0Ô∏è‚É£ Exit
""")

    choice = input("Enter your choice: ")

    if choice == '1':
        insert_student()
    elif choice == '2':
        view_students()
    elif choice == '3':
        search_students()
    elif choice == '4':
        update_student()
    elif choice == '5':
        delete_student()
    elif choice == '6':
        drop_table()
    elif choice == '0':
        print("üëã Exiting program. Goodbye!")
        break
    else:
        print("‚ùå Invalid choice! Please try again.\n")

# ----------- CLOSE CONNECTION -----------
cursor.close()
conn.close()
