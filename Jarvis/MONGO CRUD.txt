# =============================================================
# ğŸ MongoDB CRUD Operations using PyMongo (With User Input)
#  pip install pymongo
# =============================================================

from pymongo import MongoClient

# ---------- CONNECT TO MONGODB ----------
client = MongoClient("mongodb://localhost:27017/")  # Default local connection
db = client["studentDB"]  # Database
collection = db["students"]  # Collection (table equivalent)

print("=============================================")
print("      ğŸ“˜ MongoDB CRUD OPERATIONS")
print("=============================================")

while True:
    print("""
    1ï¸âƒ£ Insert Record (CREATE)
    2ï¸âƒ£ Display Records (READ)
    3ï¸âƒ£ Update Record (UPDATE)
    4ï¸âƒ£ Delete Record (DELETE)
    5ï¸âƒ£ Exit
    """)
    
    choice = input("Enter your choice (1-5): ")

    # ---------- CREATE ----------
    if choice == '1':
        name = input("Enter student name: ")
        roll = int(input("Enter roll number: "))
        marks = float(input("Enter marks: "))
        record = {"name": name, "roll": roll, "marks": marks}
        collection.insert_one(record)
        print("âœ… Record inserted successfully!")

    # ---------- READ ----------
    elif choice == '2':
        print("\nğŸ“„ All Student Records:")
        for doc in collection.find():
            print(doc)

    # ---------- UPDATE ----------
    elif choice == '3':
        roll = int(input("Enter roll number to update: "))
        new_marks = float(input("Enter new marks: "))
        result = collection.update_one({"roll": roll}, {"$set": {"marks": new_marks}})
        if result.modified_count > 0:
            print("âœ… Record updated successfully!")
        else:
            print("âš ï¸ Record not found!")

    # ---------- DELETE ----------
    elif choice == '4':
        roll = int(input("Enter roll number to delete: "))
        result = collection.delete_one({"roll": roll})
        if result.deleted_count > 0:
            print("ğŸ—‘ï¸ Record deleted successfully!")
        else:
            print("âš ï¸ Record not found!")

    # ---------- EXIT ----------
    elif choice == '5':
        print("ğŸ‘‹ Exiting program...")
        break

    else:
        print("âŒ Invalid choice! Try again.")
