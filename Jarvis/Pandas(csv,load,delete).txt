# ============================================================
# üìò PANDAS - All in One Program (NO R NEEDED)
#pip install pandas numpy matplotlib seaborn
#
# Topics:
# 1. Installation of Pandas
# 2. Import Pandas
# 3. Read CSV Files
# 4. Viewing the Data
# 5. Cleaning Data
# 6. Removing Duplicates
# ============================================================

# ------------------------------------------------------------
# 1Ô∏è‚É£ INSTALLATION (run in terminal if not installed)
# ------------------------------------------------------------
# pip install pandas

# ------------------------------------------------------------
# 2Ô∏è‚É£ IMPORT PANDAS
# ------------------------------------------------------------
import pandas as pd

print("\n‚úÖ Pandas Imported Successfully!")

# ------------------------------------------------------------
# 3Ô∏è‚É£ READ CSV FILE (User Input)
# ------------------------------------------------------------
file_name = input("\nEnter the CSV file name (with .csv extension): ")

try:
    df = pd.read_csv(file_name)
    print("\n‚úÖ CSV File Loaded Successfully!\n")

except FileNotFoundError:
    print("‚ùå File not found! Loading sample data instead...\n")
    # Create a small sample dataset
    data = {
        'Name': ['Pratik', 'Dadu', 'Riya', 'Pratik', 'Amit', 'Riya'],
        'Age': [21, 22, None, 21, 23, 22],
        'City': ['Pune', 'Mumbai', 'Delhi', 'Pune', 'Nagpur', 'Delhi']
    }
    df = pd.DataFrame(data)

# ------------------------------------------------------------
# 4Ô∏è‚É£ VIEWING THE DATA
# ------------------------------------------------------------
print("üîπ First 5 Rows (head):")
print(df.head())

print("\nüîπ Last 5 Rows (tail):")
print(df.tail())

print("\nüîπ Data Info:")
print(df.info())

print("\nüîπ Summary Statistics:")
print(df.describe())

# ------------------------------------------------------------
# 5Ô∏è‚É£ CLEANING DATA
# ------------------------------------------------------------
print("\nüßπ Cleaning Data...")

# Check for missing values
print("\nMissing values before cleaning:")
print(df.isnull().sum())

# Fill missing values (with mean)
df['Age'].fillna(df['Age'].mean(), inplace=True)

print("\nMissing values after filling:")
print(df.isnull().sum())

# ------------------------------------------------------------
# 6Ô∏è‚É£ REMOVING DUPLICATES
# ------------------------------------------------------------
print("\nüìã Checking for Duplicates:")
print(df[df.duplicated()])

# Remove duplicates
df.drop_duplicates(inplace=True)

print("\n‚úÖ After Removing Duplicates:")
print(df)

# ------------------------------------------------------------
# 7Ô∏è‚É£ SAVE CLEANED DATA
# ------------------------------------------------------------
save_option = input("\nDo you want to save cleaned data to 'cleaned_data.csv'? (yes/no): ")
if save_option.lower() == 'yes':
    df.to_csv("cleaned_data.csv", index=False)
    print("üíæ Cleaned data saved successfully as 'cleaned_data.csv'!")

print("\nüéØ PROGRAM COMPLETED SUCCESSFULLY!")
